-- roles/database/templates/app_schema.sql.j2

-- Creamos la base de datos si no existe
CREATE DATABASE IF NOT EXISTS `{{ app_db.name }}` 
  CHARACTER SET utf8mb4 
  COLLATE utf8mb4_unicode_ci;

USE `{{ app_db.name }}`;

-- Tabla donde la app inserta sus usuarios
CREATE TABLE IF NOT EXISTS `user_app` (
  `id`             INT AUTO_INCREMENT PRIMARY KEY,
  `username`       VARCHAR(150) NOT NULL UNIQUE,
  `password_hash`  CHAR(128)    NOT NULL,
  `role_id`        INT          NOT NULL DEFAULT 3,
  `created_at`     TIMESTAMP    NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
